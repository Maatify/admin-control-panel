# ุฏููู ุจุฏุก ุงูุนูู (Onboarding Guide)

**ุงููุดุฑูุน:** ููุญุฉ ุชุญูู ุงูุฅุฏุงุฑุฉ (Admin Control Panel)
**ุงููุณุฎุฉ:** Current State (Infrastructure-First)
**ุงููุบุฉ:** PHP 8.2 (Slim Framework) + Twig + MySQL

---

## 1๏ธโฃ ููุฏูุฉ ุณุฑูุนุฉ (Executive Overview)

ูุฐุง ุงููุดุฑูุน ูู **Backend-Heavy Admin System** ูุจูู ุจุชุฑููุฒ ุฃุณุงุณู ุนูู ุงูุฃูุงู (Security-First) ูููุณ ุงูุณุฑุนุฉ ุฃู ุงูู Features.

### ูุง ูู ูุฐุง ุงููุดุฑูุนุ
ูู ูุธุงู ุฅุฏุงุฑุฉ ูุฑูุฒู ูุนุชูุฏ ุนูู **Zero-Trust Architecture**ุ ููุง ูุนูู:
* ูู Request ูุชู ูุญุตู ุนุจุฑ ุนุฏุฉ ุทุจูุงุช (Middleware Pipeline).
* ุงูุฌูุณุงุช (Sessions) ุชุชุทูุจ ุชุญูู ุตุงุฑู (Strict Validation).
* ุงูุนูููุงุช ุงูุญุณุงุณุฉ ุชุชุทูุจ ุชุญูู ุฅุถุงูู (Step-Up Auth).

### ุชุญุฐูุฑ ูุงู โ
> **ุฃู ุชุนุฏูู ุจุฏูู ููู ูุงูู ููุฐู ุงููุซููุฉ = ูุฎุงุทุฑุฉ ุฃูููุฉ ุนุงููุฉ.**
> ุงููุธุงู ูุญุชูู ุนูู ูููุฏ (Invariants) ูู ุงูููุฏ ุชููุน ุงูุฃุฎุทุงุก ุงูุดุงุฆุนุฉ. ูุง ุชุญุงูู ุงูุงูุชูุงู ุนูููุง (Bypass).

---

## 2๏ธโฃ ุทุฑููุฉ ุงูุนูู ูุน GitHub (Workflow)

ููุญูุงุธ ุนูู ุงุณุชูุฑุงุฑ ุงูููุฏุ ูุชุจุน ุงูููุงุนุฏ ุงูุชุงููุฉ ุจุตุฑุงูุฉ:

1.  **Clone**: ูู ุจูุณุฎ ุงููุดุฑูุน `git clone ...`
2.  **Branching**:
    *   ููููุฒุงุช ุงูุฌุฏูุฏุฉ: `feature/your-feature-name`
    *   ููุฅุตูุงุญุงุช: `fix/issue-description`
3.  **Pull Safety**: ุชุฃูุฏ ุฏุงุฆูุงู ูู ุณุญุจ ุขุฎุฑ ุงูุชุบููุฑุงุช ูุจู ุจุฏุก ุงูุนูู: `git pull origin main --rebase`
4.  **No Direct Push**: ููููุน ููุงุฆูุงู ุงูุฑูุน ุงููุจุงุดุฑ ุนูู `main`.
5.  **Clean History**: ุงุณุชุฎุฏู ุงูู Squash ูุจู ุงูุฏูุฌ ููุญูุงุธ ุนูู ูุธุงูุฉ ุงูู Git Log.

---

## 3๏ธโฃ ุชุดุบูู ุงููุดุฑูุน ูุญูููุง (Local Setup)

ุงููุธุงู ูุตูู ููุนูู ุจุฃูู ูุชุทูุจุงุช ููููุฉุ ููู ุจุจูุฆุฉ ูุญุฏุฏุฉ:

### ุงููุชุทูุจุงุช (Prerequisites)
*   **PHP**: ุงูุฅุตุฏุงุฑ `8.2` ุฃู ุฃุญุฏุซ (ูุทููุจ ูู `composer.json`).
*   **Extensions**: `pdo`, `openssl`, `redis`, `mbstring`.
*   **Composer**: ุฃุญุฏุซ ุฅุตุฏุงุฑ.

### ุฎุทูุงุช ุงูุชุดุบูู
1.  **ุชุซุจูุช ุงูุญุฒู**:
    ```bash
    composer install
    ```
2.  **ุฅุนุฏุงุฏ ุงูุจูุฆุฉ**:
    *   ุงูุณุฎ ููู `env.example` ุฅูู `.env`.
    *   ูู ุจุชุนุจุฆุฉ ููู ุงูุงุชุตุงู ุจูุงุนุฏุฉ ุงูุจูุงูุงุช (DB_HOST, DB_NAME, ...).
    *   **ูุงู**: ุชุฃูุฏ ูู ูุถุน ููู ูููุฉ ูู `ENCRYPTION_KEY` ู `EMAIL_BLIND_INDEX_KEY`.
3.  **ุชุดุบูู ุงูุณูุฑูุฑ**:
    ููููู ุงุณุชุฎุฏุงู ุงูู Built-in Server ููุชุทููุฑ:
    ```bash
    php -S localhost:8080 -t public
    ```
    ุงูุขู ุงููุธุงู ูุนูู ุนูู: `http://localhost:8080`

---

## 4๏ธโฃ ุฅูุดุงุก ุฃูู Admin (BOOTSTRAP) โ **CRITICAL**

ุงููุธุงู ูุจุฏุฃ **ููููู ุชูุงูุงู (Locked)**. ูุง ููุฌุฏ ูุณุชุฎุฏู ุงูุชุฑุงุถู (ูุซู `admin/admin`)ุ ููุง ุชูุฌุฏ ูุงุฌูุฉ ุชุณุฌูู (Register API) ุนุงูุฉ.

### ุงูุทุฑููุฉ ุงููุญูุฏุฉ ููุฏุฎูู:
ูุฌุจ ุงุณุชุฎุฏุงู ุณูุฑูุจุช ุงูู Bootstrap ุนุจุฑ ุงูู Terminal ูุฅูุดุงุก Token ูุณุชุฎุฏู ููุฑุฉ ูุงุญุฏุฉ (One-Time Token).

#### ุงููุณุงุฑ ุงูุตุญูุญ ููุท:
1.  **Bootstrap ุนุจุฑ CLI**: ุชุดุบูู ุงูุณูุฑูุจุช ูุฅูุดุงุก ุงูุชููู.
2.  **Token one-time**: ูุณุฎ ุงูุชููู ุงูุฐู ูุธูุฑ ูู ุงูู Console.
3.  **ุฅุฏุฎุงู ุงูุชููู ุนุจุฑ UI**: ุงุณุชุฎุฏุงู ุงูุชููู ูู ุตูุญุฉ ุงูุจุฏุงูุฉ.
4.  **ุชูุนูู TOTP ุฅุฌุจุงุฑู**: ุงููุธุงู ุณูุฌุจุฑู ุนูู ุชูุนูู ุงูู Authenticator ููุฑุงู.

โ **ุชุญุฐูุฑ**: ูุง ุชุญุงูู ุฅุฏุฎุงู ุจูุงูุงุช ูุฏููุงู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ุฃู ุชุฌุงูุฒ ูุฐู ุงูุฎุทูุงุช. ุฃู ูุญุงููุฉ ุงุฎุชุตุงุฑ ุณุชุคุฏู ููุณุฑ ุงููุธุงู ุงูุฃููู.

---

## 5๏ธโฃ ุงูุฏุฎูู ุนูู ูุงุนุฏุฉ ุงูุจูุงูุงุช (phpMyAdmin)

ูู ุจูุฆุฉ ุงูุชุทููุฑุ ูุฏ ุชุญุชุงุฌ ููุญุต ุงูุจูุงูุงุช. ุชุฃูุฏ ูู ุฅุนุฏุงุฏุงุช ุงูุงุชุตุงู ูู `.env`.

### ุงูุฌุฏุงูู ุงููููุฉ:
*   **`admins`**
*   **`identifiers`**
*   **`sessions`**
*   **`audit_outbox`**

โ **ูุงุนุฏุฉ ุฐูุจูุฉ**: ููููุน ุงูุชุนุฏูู ุงููุฏูู ุนูู ุฃู ุฌุฏูู ุฃููู ูุชุฌุงูุฒ ุงูุฏุฎูู. ุงููุธุงู ุณููุชุดู ุงูุชูุงุนุจ (Tampering) ููุฏ ูุบูู ุงูุญุณุงุจ.

---

## 6๏ธโฃ ุฎุฑูุทุฉ ุงูู Endpoints ุงูุญุงููุฉ (CURRENT ONLY)

ูุฐู ูู ุงูู Routes ุงููุชุงุญุฉ ูุงููุนุงูุฉ ุญุงููุงู:

### Auth
*   `POST /auth/login`
*   `POST /auth/logout`
*   `POST /auth/totp/verify`

### Admins
*   `GET /admins`
*   `POST /admins`
*   `PUT /admins/{id}`

### Sessions
*   `GET /sessions`
*   `POST /sessions/{id}/revoke`

> ๐ **ููุงุญุธุฉ**: ุฃู Endpoint ุบูุฑ ูุฐููุฑ ููุง = ุบูุฑ ูุชุงุญ ุฃู ุบูุฑ ููุชูู.

---

## 7๏ธโฃ Frontend & Twig โ **HOW TO WORK SAFELY**

ูููุทูุฑูู ุงูุฐูู ูุนูููู ุนูู ุงููุงุฌูุงุช (UI):

### ููุงู ุงููููุงุช
*   ุฌููุน ูููุงุช ุงูู View ููุฌูุฏุฉ ุฏุงุฎู ูุฌูุฏ `templates/`.
*   ูุณุชุฎุฏู ุงููุธุงู ูุญุฑู **Twig**.

### ููุงุนุฏ ุงูุนูู
1.  **Controller โ View**: ุงูู Controller ูุฌูุฒ ุงูุจูุงูุงุช (DTOs) ูููุฑุฑูุง ููู View. ููููุน ูุชุงุจุฉ ุฃู Logic ูุนูุฏ ุฏุงุฎู ูููุงุช `.twig`.
2.  **ูุง ููุฃูุงู ูู ุงููุงุฌูุฉ**: ูุง ุชุนุชูุฏ ุนูู `{% if is_admin %}` ูุญูุงูุฉ ุงูุฃุฒุฑุงุฑ ููุท. ุงูุญูุงูุฉ ุงูุญููููุฉ ูู ุงูู Backend. ุฅุฎูุงุก ุงูุฒุฑ ูุง ูุนูู ููุน ุงููุนู.
3.  **Strict Typing**: ุชุนุงูู ูุน ุงููุชุบูุฑุงุช ุงููุงุฏูุฉ ูู ุงูู Controller ุจุญุฐุฑ. ุงุณุชุฎุฏู ุงูููุงุชุฑ `{{ var|e }}` ููุญูุงูุฉ ูู XSS.
4.  **Translation Keys**: ุงุณุชุฎุฏุงู ููุงุชูุญ ุงูุชุฑุฌูุฉ ููุท (Phase 11) ูููุตูุต ุงูุซุงุจุชุฉ.

---

## 8๏ธโฃ ููุงุนุฏ ุฐูุจูุฉ ูููุฑูููู (Golden Rules)

1.  โ **ูุง ุชุถูู Auth Logic**: ูุธุงู ุงูู Authentication ูุงูู Authorization ูุฑูุฒู. ูุง ุชุญุงูู ูุชุงุจุฉ ุฌูู `if ($user->isAdmin)` ูุฏููุงู ูู ุงูู Controllers. ุงุณุชุฎุฏู ุงูู Middleware.
2.  โ **ูุง ุชุบูุฑ Permission Semantics**: ูุนูู ุงูุตูุงุญูุงุช ูุญุฏุฏ ูู ุงูููุฏ (Domain Enums). ูุง ุชุบูุฑู ูุชูุงุณุจ ุงููุงุฌูุฉ.
3.  โ **ูุง ุชุนุชูุฏ ุนูู session ููููุฉ**: ุงูู Session ID ูุชุบูุฑุ ุงููููุฉ ุงูุซุงุจุชุฉ ูู `admin_id`.
4.  โ **ูุง ุชุณุชุฎุฏู admin_id ูู UI**: ุชุฌูุจ ุนุฑุถ ุงูู IDs ุงูุญููููุฉ ูู ุงูู URLs ุงูุนุงูุฉ ุฅู ุฃููู.
5.  โ **ุฃู ุดู = ุงุณุฃู**: ุฅุฐุง ูุฌุฏุช ููุฏุงู ูุจุฏู "ูุนูุฏุงู ุจูุง ุฏุงุนู"ุ ููู ุบุงูุจุงู ูุฐูู ูุณุจุจ ุฃููู. ูุง ุชูู ุจุชุจุณูุทู (Refactor) ูุจู ููู ุงูุณุจุจ.

---

## 9๏ธโฃ ุญุฏูุฏ ุงููุฑุญูุฉ ุงูุญุงููุฉ (Phase Boundary)

ูุญู ุญุงููุงู ูู ูุฑุญูุฉ **Infrastructure & Core Security**.

*   **ุงูููุชูู**: ุชุณุฌูู ุงูุฏุฎููุ ุงูุชุญูู ุงูุซูุงุฆู (2FA)ุ ุฅุฏุงุฑุฉ ุงูุฅุดุนุงุฑุงุช ุงูุฃุณุงุณูุฉุ ูุงูู Audit Logging.
*   **ุบูุฑ ุงููุณููุญ**: ุฅุถุงูุฉ ููุฒุงุช "Business Logic" ุฎุงุตุฉ ุจุงูุชุทุจูู ุงูููุงุฆู (ูุซู ุฅุฏุงุฑุฉ ุงูููุชุฌุงุช ุฃู ุงููุณุชุฎุฏููู) ูุจู ุงูุชูุงู ุทุจูุฉ ุงูุฅุฏุงุฑุฉ ุชูุงูุงู.
*   **ุงููุดุฑูุน ูุณู Infrastructure-first**.

---

## ๐ ุฎุงุชูุฉ

ูุฐุง ุงูููู `docs/ONBOARDING.md` ูู ุงููุฑุฌุน ุงููุญูุฏ ููุชุดุบูู.
ูู ุญุงู ูุฌูุฏ ุฃู ุชุนุงุฑุถ -> ูุฐุง ุงูููู ูู ุงูุตุญูุญ.
ุฃู ุงูุชุฑุงุญ ุชุทููุฑ -> ุฎุงุฑุฌ ูุฐุง ุงูุฏููู.

**ุจุงูุชูููู!**
